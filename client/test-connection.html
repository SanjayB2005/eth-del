<!DOCTYPE html>
<html>
<head>
    <title>Test Server Connection</title>
</head>
<body>
    <h1>Test Server Connection</h1>
    <button onclick="testHealth()">Test Health Endpoint</button>
    <button onclick="testUpload()">Test Upload with Wallet</button>
    <div id="results"></div>

    <script>
        const results = document.getElementById('results');
        
        function log(message, isError = false) {
            const div = document.createElement('div');
            div.style.padding = '5px';
            div.style.margin = '5px 0';
            div.style.backgroundColor = isError ? '#ffebee' : '#e8f5e9';
            div.style.border = isError ? '1px solid #f44336' : '1px solid #4caf50';
            div.textContent = message;
            results.appendChild(div);
        }

        async function testHealth() {
            results.innerHTML = '';
            log('Testing health endpoint...');
            
            try {
                const response = await fetch('http://localhost:3001/api/health');
                log(`Health status: ${response.status}`);
                
                if (response.ok) {
                    const data = await response.json();
                    log(`Health response: ${JSON.stringify(data, null, 2)}`);
                } else {
                    log('Health check failed', true);
                }
            } catch (error) {
                log(`Health error: ${error.message}`, true);
            }
        }

        async function testUpload() {
            results.innerHTML = '';
            log('Testing upload with wallet address...');
            
            const testWallet = '0x1234567890123456789012345678901234567890';
            const testContent = 'Test file from browser';
            
            try {
                const formData = new FormData();
                const blob = new Blob([testContent], { type: 'text/plain' });
                formData.append('file', blob, 'browser-test.txt');
                formData.append('metadata', JSON.stringify({ source: 'browser-test' }));
                
                log(`Using wallet: ${testWallet}`);
                
                const response = await fetch('http://localhost:3001/api/upload', {
                    method: 'POST',
                    headers: {
                        'X-Wallet-Address': testWallet,
                    },
                    body: formData
                });
                
                log(`Upload status: ${response.status}`);
                
                if (response.ok) {
                    const data = await response.json();
                    log(`Upload response: ${JSON.stringify(data, null, 2)}`);
                } else {
                    const errorText = await response.text();
                    log(`Upload failed: ${errorText}`, true);
                }
            } catch (error) {
                log(`Upload error: ${error.message}`, true);
            }
        }
    </script>
</body>
</html>